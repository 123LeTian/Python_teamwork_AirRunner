# AirRunner- 智能体感跑酷交互系统

AirRunner 使用摄像头手势或动作转换为键盘输入，支持网页跑酷类游戏。
提供桌面手势模式与面部鼻尖模式。
通过将游戏交互与肢体伸展相结合，让用户在工作、学习间隙自然轻松地活动颈椎与手腕，缓解长期伏案带来的肌肉僵硬，同时收获游戏的乐趣。

## 核心价值
- 大健康理念：在娱乐中完成颈椎屈伸与左右侧屈运动。
- 无感交互：无需穿戴任何传感器，普通笔记本摄像头即可使用。
- 工程化闭环：具备完整的用户界面、智能校准、异常保护（防呆）及数据可视化分析功能。

## 功能特点
- 手势模式：单手“虚拟摇杆”控制上下左右。
- 面部模式：鼻尖位置映射为跳/蹲/左/右。
- HUD 叠加显示 FPS 与动作反馈。
- 键位映射支持方向键/ WASD（Windows 优先 pydirectinput）。

## 核心功能

### 1. 双模态控制体系
😊 面部模式：通过追踪鼻尖坐标，检测头部/身体的上挺（跳跃）、下蹲、左倾、右倾动作。
🖐 手势模式：基于“虚拟摇杆”算法。检测手掌在屏幕中的相对位置，移出中心安全区即可触发方向指令。

### 2. 增强型用户体验
CyberHUD 抬头显示：实时绘制 FPS、动作指令、倒计时及光线警告，提供极具科技感的视觉反馈。
智能自动暂停：具有鲁棒性设计。当用户离开摄像头视野超过 2 秒，系统自动触发暂停键（ESC）并锁定游戏，防止角色死亡。
沉浸式音效：动作触发成功、倒计时、警告均有独立音效反馈，提升交互确认感。

### 3. 数据可视化与持久化
运动报告：每次游戏结束自动弹出结算窗口，显示坚持时长及动作次数统计。
历史趋势图：集成 `Matplotlib`，读取 `game_history.csv`，以柱状图形式直观展示用户最近 7 次的游戏活跃度（热量消耗估算），体现数据分析能力。

### 4. 工程化封装
配置管理：支持灵敏度微调、主题切换（深色/浅色），配置自动保存至 `user_config.json`。
独立运行：支持 PyInstaller 打包为 `.exe`，内置资源路径寻址算法，无需安装 Python 环境，实现“开箱即用”。

## 运行环境
- Python 3.9+
- 摄像头
- 依赖：mediapipe、opencv-python、customtkinter
- 输入后端：
  - Windows：pydirectinput（优先），pyautogui（其次）
  - macOS/Linux：pyautogui

## 安装依赖
```bash
pip install mediapipe opencv-python customtkinter pyautogui pydirectinput matplotlib pandas pygame
```

## 运行
方式一：
直接运行 dist/AirRunner.exe 即可，无需安装 Python 环境。

方式二：
```bash
python main.py
```

## 操作说明
- ESC：退出程序（需先点击摄像头窗口）。

## 模式说明
### 手势模式
- 手移出中心安全区触发上下左右。
- 握拳触发 PAUSE（发送 ESC）。

### 面部（鼻尖）模式
- 鼻尖位置相对中心区（0.4~0.6）触发跳/蹲/左/右。

## 注意事项
- 启动后需点击浏览器窗口以获取键盘焦点。
- 摄像头窗口置顶显示，便于观察。
- 阈值与冷却时间在 `controllers.py`、`game_adapter.py` 中调整。

## 测试脚本
- `hand_algo.py`：手势模式本地测试（主程序不使用）。
- `body_algo.py`：面部模式本地测试（主程序不使用）。

## 文件说明
- `main.py`：启动器 UI 与主循环。
- `controllers.py`：手势/面部识别逻辑。
- `game_adapter.py`：动作到按键映射与输入后端。
- `ui_drawer.py`：HUD绘制。
- `utils.py`：配置管理、音频管理、历史记录管理。
- `user_config.json`：用户配置文件。
- `game_history.csv`：运动历史数据。
- `icon.ico`：程序图标。
- `beep.mp3`：音效文件。
- `success.mp3`：音效文件。